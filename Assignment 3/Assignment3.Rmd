---
title: "Opening the Black Box - Determinants of Tax Morale in Africa"
author: "Wiebke Weiger & Jasmin Cantzler"
date: "13 November 2015"
output:
  pdf_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
  html_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
---
\pagebreak
```{r, include=FALSE}
##################################
# Assignment 3
# Jasmin Cantzler & Wiebke Weiger
# 13 November 2015
##################################

# Set working directory
#setwd("C:/Users/Wiebke/Documents/RepRes/TaxMorale/Assignment 3/PreparatoryWork")
setwd("/Users/jasmincantzler/Documents/TaxMorale/Assignment 3/PreparatoryWork")

#STEP 1 OF ASSIGNMENT: GATHERS WEB BASED DATA FROM AT LEAST TWO SOURCES, MERGES THE DATA SETS 
#to load the R file that contains the merging of the different data sets please
# source('merging_data.R') 

# for sake of ease we directly load the final dataset that is the result of the file above
mydata <- read.csv('Afrobarometer.final.csv')

# Load packages
library(MASS)
library(ggplot2)
library(knitr)
library(dplyr)
library(stargazer)

#creates Tax Morale as a numeric variable
TaxMoraleNumeric <- as.numeric(mydata$TaxMorale)

# STEP 2 OF ASSIGNMENT: CONDUCTS BASIC DESCRIPTIVE STATISTICS 
summary(mydata) 
summary(mydata$TaxMorale)
summary(TaxMoraleNumeric)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
# 1.000   1.000   2.000   2.351   4.000   5.000    6539 
sd(TaxMoraleNumeric, na.rm=TRUE)
#[1] 1.445466

#creates a histogram of our dependent variable Tax Morale
qplot(mydata$TaxMorale,
      geom="histogram",
      binwidth=8,
      main="Summary Statistic",
      xlab="The tax department always has the right to make people pay taxes.",
      fill=I("lightblue"))

summary_df <- mydata %>% 
  group_by(Country) %>% 
  summarise(
    meanage = mean(Age,na.rm=TRUE), 
    meantaxmorale = mean(TaxMoraleNumeric, na.rm=TRUE)
  )

# STEP 3: CONDUCTS INFERENTIAL STATISTICS
# Comment: as you see in the histogram, our variable is skewed, which is also the case if we transform it to natural log. 
# summary(TaxMoraleNumeric)
# hist(TaxMoraleNumeric)
# log(TaxMoraleNumeric) %>% hist(main = "TaxMoraleNumeric")

# use the polr command from the MASS package to estimate an ordered logistic regression model. 
# specify HESS=TRUE to have the model return the observed information matrix from optimization which is used to get standard errors

reg1<-polr(TaxMorale ~ CorruptionPresident, data=mydata, Hess = TRUE)
summary(reg1)
?stargazer

#store table
(ctable <- coef(summary(reg1)))

#calculate and store p values
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2

## combined table
(ctable <- cbind(ctable, "p value" = p))
```

#Introduction

A country's ability to efficiently mobilize its national resources is a topic that has recently been gaining traction in the discussion surrounding development. Since the Monterrey Consensus was adopted in 2002, in which countries recognized the importance of raising domestic revenues, development aid has been increasingly shifting from direct financial assistance to improving tax system and national resource management. This shift in strategy was officially stated in 2008, in the Doha Declaration on Financing for Development, which pledged to enhance national tax revenues; one of the recognized strategies pledged to achieve this was combating tax evasion.
  
High levels of tax evasion lead to a misallocation of resources and hinder the ability of the government to invest in the provision of public goods. Therefore, understanding the rationale behind tax evaders becomes essential to national development and state building. Tradtionally, the standard way to explain tax compliance has been the economics-of-crime approach, which assumes a rational taxpayer maximizing his or her utility by balancing the risk of detection and punishment with the benefit of tax evasion. Today, this approach is increasingly regarded as too narrow to fully explain tax compliance, and many argue for the need to include social factors, which are said to explain why people conform to paying taxes even in the absence of strong deterrence mechanisms. These social factors constitute and influence the individual's "intrinsic motivation to pay taxes", hereafter referred to as tax morale, by increasing moral costs of tax evasion and thus increasing tax compliance.

Against this background, the purpose of our research paper is to identify the determinants of tax morale in African countries, thereby opening the door for new policies fostering tax morale and thus tax compliance and increased public revenues in African countries. Using data from the Afrobarometer, we conduct a regression analysis using the commonly identified determinants of tax morale to test whether these also hold in developing countries; or more specifically, in African countries. Generally, the few studies that do look inside the black box of tax morale find that factors such as trust in government, the level of corruption, interactions with other taxpayers and tax administrators, tax burden, perception about benefits of public spending, social norms, detection, and punishment, gender all determine tax morale and hence influence tax compliance. Our conceptual framework is therefore based on the determinants of tax morale in developed countries, whereby:

\begin{equation}
\begin{aligned}
Tax Morale_i = & \alpha_i + \beta_1 Trust in Government/Public Officials_i + \beta_2 Level of Corruption_i \\
& + \beta_3 interactions with other taxpayers_i + \beta_4 tax burden_i \\
& + \beta_5 detection and punishment_i + \beta_5 Social Norms_i + \epsilon_i
\end{aligned}
\end{equation}

This paper briefly outlines the design, operationalization and data selection, before conducting a first regression analysis and briefly describing its results. More extensive information will be available in the final report. 

#Method

##Data Selection and Operationalization

As outlined in Assignment 1, we make use of the Afrobarometer Surveys to investigate the determinants of tax morale in African countries. We merged the survey results from Round 3, 4 and 5, resulting in a data set that spans the years 2005-2006, 2008-2010 and 2011-2013.

##Descriptive Statistics of Our Data

**Table 1 in the columns 2, 3 and 4 shows for each country the percentage of individuals saying that tax evasion is never justifiable. Columns 5, 6, and 7 give the mean value for all countries based on a scale from 0 to 3, were 3 is the highest tax morale (value 0 integrates the values 4 to 10).**

```{r, echo=FALSE}
stargazer::stargazer(reg1,
    title = 'Logistic Regression Estimates of Grad School Acceptance',
    digits = 2, type='latex', header=FALSE)

kable(summary_df)

qplot(mydata$TaxMorale,
      geom="histogram",
      binwidth=8,
      main="Summary Statistic",
      xlab="The tax department always has the right to make people pay taxes.",
      fill=I("lightblue"))
```

The average values in Table 1 give a first overview about tax morale in African countries; in general .... seems to have higher tax morale than...

##Inferential Statistics

A regression analysis is used to investigate the determinants of tax morale in African countries. Our dependent variable[^1] asks the participants to agree or disagree with the statement "The tax department always has the right to make people pay taxes." The variable is measured from  "Strongly Disagree", "Disagree", "Neither Agree or Disagree", "Agree", "Strongly Agree". Since we believe that the "distances" between these five points are not equal, an OLS regression in this case is problematic because the assumptions of OLS are violated when used with a non-interval outcome variable. Instead, we opted for an ordered logistic regression. 



#Discussion & Open Questions
1. Since many of our dependent variables are also nominal we are still investigating whether there are more suitable regression models applicable than ordinal logistic regression. After all, at this point we are treating the dependent variables as numerical. Academic opinions seem strongly divided whether it is okay or highly problematic - what would be your take on this?






[^1]: For Round 3 (Codebook 2005) it is variable Q52D, for Round 4 (Codebook 2008) it is Q44C, and for Round 5 (2015) it is Q48C.